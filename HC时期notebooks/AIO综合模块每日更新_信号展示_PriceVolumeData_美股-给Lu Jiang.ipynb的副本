{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd, numpy as np\n",
    "from datetime import datetime\n",
    "import statsmodels.api as sm\n",
    "import yfinance as yf\n",
    "import time, urllib\n",
    "import glob\n",
    "import os\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "%matplotlib inline\n",
    "sns.set(context='notebook', style='darkgrid', palette='deep', font='sans-serif', font_scale=1, color_codes=False, rc=None)\n",
    "\n",
    "# 导入自己的模块\n",
    "from data_download_US_HK import *\n",
    "from strategies import *\n",
    "from positions import *"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 模块一：下载数据到csv文件"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Length of all tickers here: 360\n"
     ]
    }
   ],
   "source": [
    "us_tickers = list(set(US_TICKERS_POOL.us_tech_stocks() + \\\n",
    "\t\t\t              US_TICKERS_POOL.us_blockchain_stocks() + \\\n",
    "\t\t\t              US_TICKERS_POOL.us_saas_stocks() + \\\n",
    "\t\t\t              US_TICKERS_POOL.us_biotech_stocks() + \\\n",
    "\t\t\t              US_TICKERS_POOL.us_new_energy_stocks() + \\\n",
    "\t\t\t              US_TICKERS_POOL.global_etfs() + \\\n",
    "\t\t\t              US_TICKERS_POOL.sector_etf() + \\\n",
    "\t\t\t              US_TICKERS_POOL.global_indices() +\\\n",
    "\t\t\t              US_TICKERS_POOL.us_healthcare_stocks() +\\\n",
    "\t\t\t              US_TICKERS_POOL.us_fin_stocks() +\\\n",
    "\t\t\t              US_TICKERS_POOL.us_utilities_stocks() +\\\n",
    "\t\t\t              US_TICKERS_POOL.us_materials_stocks() +\\\n",
    "\t\t\t              US_TICKERS_POOL.other_us_stocks() +\\\n",
    "                            US_TICKERS_POOL.us_consumer_discretionary_stocks() +\\\n",
    "                            US_TICKERS_POOL.us_consumer_staples_stocks() +\\\n",
    "                            US_TICKERS_POOL.us_industrial_stocks() +\\\n",
    "                            US_TICKERS_POOL.us_real_estate_stocks() +\\\n",
    "                            US_TICKERS_POOL.us_tele_entertainment_stocks()\n",
    "                          ))\n",
    "\n",
    "# global_etfs_leveraged = list(set([\"TQQQ\",#纳指100x3\n",
    "# \t\t\t\t\t\"UPRO\",#标普x3                        \n",
    "# \t\t\t\t\t\"UDOW\",#道指x3\n",
    "                        \n",
    "\n",
    "# \t\t\t\t\t\"USD\", # 半导体行业x2\n",
    "# \t\t\t\t\t\"SOXL\", # 半导体行业x3\n",
    "# \t\t\t\t\t\"UYG\",# 金融双倍做多\n",
    "# \t\t\t\t\t\"URE\",# 房地产双倍做多\n",
    "# \t\t\t\t\t\"DRN\",#x3\n",
    "# \t\t\t\t\t\"DIG\",# 能源双倍做多\n",
    "# \t\t\t\t\t\"ERX\",#x3\n",
    "# \t\t\t\t\t\"UYM\",# 原材料双倍做多 \n",
    "# \t\t\t\t\t\"MATL\",#x3\n",
    "# \t\t\t\t\t\"NUGT\",#黄金矿业三倍做多\n",
    "# \t\t\t\t\t\"EET\",# 新兴市场指数双倍做多\n",
    "# \t\t\t\t\t\"EDC\",#x3\n",
    "# \t\t\t\t\t\"XPP\",# 中国股票指数x2\n",
    "# \t\t\t\t\t\"UCO\",# 石油x2\n",
    "# \t\t\t\t\t\"DGP\",# 黄金x2\n",
    "# \t\t\t\t\t\"UGL\",# 黄金x2\n",
    "# \t\t\t\t\t\"AGQ\",# 白银x2\n",
    "# \t\t\t\t\t\"EUO\",# 美元x2\n",
    "# \t\t\t\t\t\"UBT\",# 政府长期债券x2\n",
    "# \t\t\t\t\t\"TMF\"# x3\n",
    "# \t\t\t\t\t]))\n",
    "futures_tickers = FUTURES.futures()\n",
    "hk_tickers = HK_TICERS_POOL.HK_tickers()\n",
    "CN_mutual_funds_tickers = CN_TICKERS_POOL.CN_fund_tickers()\n",
    "\n",
    "tickers_to_load = list(set(us_tickers+futures_tickers+hk_tickers))\n",
    "print(\"Length of all tickers here:\", len(tickers_to_load))\n",
    "\n",
    "start = \"2005-01-01\"\n",
    "today = LOAD_DATA.today_dt()\n",
    "end = today\n",
    "\n",
    "# 如果用这个yesterday，则代表着只需要到昨天的数据\n",
    "# end_yesterday = \"2021-03-02\"\n",
    "\n",
    "us_db_path = \"C:/Users/Administrator/CE_github_2/data_pipeline/Data/\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.1: 0151.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.2: 6055.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.3: CAN data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.4: EWW data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.5: ARKQ data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.6: 0493.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.7: 0777.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.8: C data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.9: VXX data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.10: 0700.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.11: 1385.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.12: 3690.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.13: VCNX data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.14: USD data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.15: RB=F data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.16: XLC data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.17: VLDR data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.18: CZR data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.19: 1610.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.20: LVS data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.21: 0763.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.22: NVAX data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.23: SHOP data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.24: ES=F data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.25: GDDY data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.26: 0215.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.27: 0419.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.28: UNH data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.29: 2342.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.30: SCO data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.31: LMT data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.32: 0008.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.33: MU data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.34: MS data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.35: 0302.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.36: YM=F data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.37: ^IXIC data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.38: 3799.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.39: SMH data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.40: AMZN data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.41: 0732.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.42: EWZ data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.43: 1883.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.44: 9999.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.45: DGP data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.46: SOXL data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.47: FMC data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.48: OKTA data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.49: TTD data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.50: 6060.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.51: FLS data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.52: SPY data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.53: SBAC data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.54: EWL data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.55: BX data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.56: 0142.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.57: MRNA data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.58: GLD data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.59: XEL data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.60: WMT data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.61: NQ=F data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.62: 1415.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.63: CDAY data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.64: EET data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.65: 0439.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.66: AZO data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.67: 8032.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.68: PTON data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.69: SBUX data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.70: 0186.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.71: 1979.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.72: ARKF data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.73: ^GSPC data file created: 2021-04-06\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.74: WORK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.75: SHW data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.76: PM data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.77: 0418.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.78: BAC data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.79: QQQ data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.80: 6993.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.81: ECL data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.82: 1475.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.83: RSX data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.84: XLK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.85: 1119.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.86: CSCO data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.87: CT=F data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.88: XLB data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.89: UYG data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.90: 1070.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.91: DBA data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.92: TLT data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.93: AEP data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.94: FXI data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.95: MARA data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.96: 1810.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.97: CMCSA data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.98: GBTC data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.99: 2018.HK data file created: 2021-04-06\n",
      "=======================Sleeping======================\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.101: ^DJI data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.102: UUP data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.103: FXE data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.104: UVXY data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.105: LLY data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.106: UPS data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.107: PLD data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.108: 0522.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.109: 9992.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.110: 0797.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.111: ADP data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.112: XAU=F data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.113: COUP data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.114: TGT data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.115: 1675.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.116: CHWY data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.117: PLUG data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.118: MCD data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.119: 2400.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.120: DHR data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.121: GOOG data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.122: EDC data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.123: 0285.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.124: 2038.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.125: TSM data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.126: HON data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.127: 1478.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.128: EUO data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.129: XLP data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.130: RNG data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.131: PAVE data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.132: 6188.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.133: FXY data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.134: TWLO data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.135: INTU data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.136: SPOT data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.137: VIR data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.138: QCOM data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.139: ISRG data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.140: EL data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.141: 3798.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.142: RIOT data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.143: XLY data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.144: XLU data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.145: PSA data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.146: NEM data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.147: DBX data file created: 2021-04-06\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.148: SBE data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.149: EBON data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.150: INTC data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.151: TEAM data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.152: MRK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.153: LAC data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.154: COST data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.155: XLE data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.156: BLNK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.157: EBAY data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.158: EWA data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.159: UBT data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.160: MSFT data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.161: DDOG data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.162: UCO data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.163: ADBE data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.164: ATVI data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.165: CRWD data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.166: ADSK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.167: ABBV data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.168: BNTX data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.169: AZN data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.170: RUN data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.171: ^HSI data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.172: MDT data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.173: OPEN data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.174: AMD data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.175: NOVA data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.176: MMM data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.177: DOCU data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.178: LOW data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.179: 0005.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.180: 6820.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.181: UYM data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.182: TME data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.183: 1833.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.184: PDD data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.185: 0175.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.186: GE data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.187: 0762.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.188: ARKK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.189: SQ data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.190: PG data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.191: BA data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.192: GS data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.193: ABT data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.194: CL data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.195: CRM data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.196: 000001.SS data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.197: 0552.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.198: EWY data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.199: 1310.HK data file created: 2021-04-06\n",
      "=======================Sleeping======================\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.201: DD data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.202: EWJ data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.203: T data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.204: 1566.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.205: ERX data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.206: APD data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.207: 2318.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.208: QS data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.209: 1909.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.210: 1024.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.211: PBW data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.212: MA data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.213: ARKG data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.214: 6823.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.215: 0596.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.216: NEE data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.217: TNA data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.218: XLV data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.219: PEP data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.220: UPRO data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.221: DLR data file created: 2021-04-06\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.222: EQIX data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.223: WES data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.224: XLRE data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.225: VEEV data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.226: PFE data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.227: 0981.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.228: MET data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.229: DUK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.230: 6618.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.231: IEF data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.232: TMF data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.233: UNP data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.234: LIN data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.235: ZEN data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.236: XPP data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.237: ARKW data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.238: SAP data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.239: CHTR data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.240: 6869.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.241: PAYC data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.242: DIG data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.243: NIO data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.244: HD data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.245: 1458.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.246: D data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.247: ORCL data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.248: STZ data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.249: AAPL data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.250: LAZR data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.251: 0788.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.252: SPLK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.253: CL=F data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.254: EWT data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.255: CAT data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.256: RTX data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.257: KHC data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.258: INDA data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.259: ALB data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.260: NVDA data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.261: 2255.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.262: BLK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.263: VZ data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.264: DIS data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.265: FXF data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.266: JNJ data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.267: EWC data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.268: URE data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.269: JPM data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.270: 0315.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.271: 8029.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.272: CVS data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.273: GC=F data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.274: 0728.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.275: NOW data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.276: NFLX data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.277: YINN data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.278: 2051.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.279: AGQ data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.280: 0941.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.281: 6862.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.282: V data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.283: 0751.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.284: BMY data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.285: 2309.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.286: 3738.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.287: KO data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.288: XL data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.289: 1347.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.290: TSLA data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.291: 2369.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.292: TMUS data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.293: 0268.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.294: RACE data file created: 2021-04-06\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.295: 2100.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.296: BABA data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.297: LTHM data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.298: SO data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.299: SQM data file created: 2021-04-06\n",
      "=======================Sleeping======================\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.301: SAM data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.302: 2382.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.303: GILD data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.304: NUGT data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.305: OSTK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.306: UDOW data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.307: ZM data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.308: AMT data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.309: NKE data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.310: ENPH data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.311: HUBS data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.312: FCEL data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.313: CB data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.314: TSN data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.315: EXC data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.316: MATL data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.317: BIDU data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.318: JD data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.319: 6088.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.320: FAS data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.321: XLI data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.322: GDX data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.323: 3888.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.324: 0241.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.325: LULU data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.326: BBY data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.327: EWU data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.328: CMG data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.329: AMGN data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.330: XPEV data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.331: INO data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.332: FXB data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.333: SMAR data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.334: SCCO data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.335: SRE data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.336: 0799.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.337: 1137.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.338: 9988.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.339: FB data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.340: EWG data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.341: GOOGL data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.342: AXP data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.343: XLF data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.344: 1588.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.345: 0698.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.346: UGL data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.347: BILI data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.348: WDAY data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.349: WFC data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.350: DRN data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.351: CCI data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.352: DBC data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.353: 0303.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.354: 6969.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.355: PYPL data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.356: 9990.HK data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.357: TQQQ data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.358: CYB data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.359: EWH data file created: 2021-04-06\n",
      "[*********************100%***********************]  1 of 1 completed\n",
      "No.360: LI data file created: 2021-04-06\n",
      "-----------------------------\n",
      "All done for 2021-04-06!\n"
     ]
    }
   ],
   "source": [
    "# download data to csv files\n",
    "# LOAD_DATA.easy_download(start, end, us_db_path, all_tickers_to_load[53:242])\n",
    "LOAD_DATA.easy_download(start, end, us_db_path,tickers_to_load)\n",
    "# LOAD_DATA.easy_download(start, end, us_db_path, [\"^HSI\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Downloading from SinaFinance: No.1 / 17: 005827\n",
      "Downloading from SinaFinance: No.2 / 17: 006792\n",
      "Downloading from SinaFinance: No.3 / 17: 010358\n",
      "Downloading from SinaFinance: No.4 / 17: 000452\n",
      "Downloading from SinaFinance: No.5 / 17: 003096\n",
      "Downloading from SinaFinance: No.6 / 17: 011609\n",
      "Downloading from SinaFinance: No.7 / 17: 001508\n",
      "Downloading from SinaFinance: No.8 / 17: 004233\n",
      "Downloading from SinaFinance: No.9 / 17: 161005\n",
      "Downloading from SinaFinance: No.10 / 17: 161725\n",
      "Downloading from SinaFinance: No.11 / 17: 010849\n",
      "Downloading from SinaFinance: No.12 / 17: 001838\n",
      "Downloading from SinaFinance: No.13 / 17: 001888\n",
      "Downloading from SinaFinance: No.14 / 17: 009865\n",
      "Downloading from SinaFinance: No.15 / 17: 110011\n",
      "Downloading from SinaFinance: No.16 / 17: 004851\n",
      "Downloading from SinaFinance: No.17 / 17: 001679\n",
      "All Data Downloaded\n"
     ]
    }
   ],
   "source": [
    "# Download data from Sina:\n",
    "LOAD_DATA.download_data_from_Sina(CN_mutual_funds_tickers, start, end, us_db_path)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Loadig Data from DB: No.1 / 265: AEP\n",
      "Loadig Data from DB: No.2 / 265: MMM\n",
      "Loadig Data from DB: No.3 / 265: DOCU\n",
      "Loadig Data from DB: No.4 / 265: FXI\n",
      "Loadig Data from DB: No.5 / 265: LOW\n",
      "Loadig Data from DB: No.6 / 265: VZ\n",
      "Loadig Data from DB: No.7 / 265: MARA\n",
      "Loadig Data from DB: No.8 / 265: DIS\n",
      "Loadig Data from DB: No.9 / 265: FXF\n",
      "Loadig Data from DB: No.10 / 265: JNJ\n",
      "Loadig Data from DB: No.11 / 265: EWC\n",
      "Loadig Data from DB: No.12 / 265: URE\n",
      "Loadig Data from DB: No.13 / 265: UYM\n",
      "Loadig Data from DB: No.14 / 265: JPM\n",
      "Loadig Data from DB: No.15 / 265: CMCSA\n",
      "Loadig Data from DB: No.16 / 265: GBTC\n",
      "Loadig Data from DB: No.17 / 265: TME\n",
      "Loadig Data from DB: No.18 / 265: CVS\n",
      "Loadig Data from DB: No.19 / 265: CAN\n",
      "Loadig Data from DB: No.20 / 265: EWW\n",
      "Loadig Data from DB: No.21 / 265: PDD\n",
      "Loadig Data from DB: No.22 / 265: ARKQ\n",
      "Loadig Data from DB: No.23 / 265: GE\n",
      "Loadig Data from DB: No.24 / 265: ES\n",
      "Loadig Data from DB: No.25 / 265: ARKK\n",
      "Loadig Data from DB: No.26 / 265: NOW\n",
      "Loadig Data from DB: No.27 / 265: SQ\n",
      "Loadig Data from DB: No.28 / 265: PG\n",
      "Loadig Data from DB: No.29 / 265: BA\n",
      "Loadig Data from DB: No.30 / 265: ^DJI\n",
      "Loadig Data from DB: No.31 / 265: NFLX\n",
      "Loadig Data from DB: No.32 / 265: GS\n",
      "Loadig Data from DB: No.33 / 265: UUP\n",
      "Loadig Data from DB: No.34 / 265: C\n",
      "Loadig Data from DB: No.35 / 265: ABT\n",
      "Loadig Data from DB: No.36 / 265: YINN\n",
      "Loadig Data from DB: No.37 / 265: CL\n",
      "Loadig Data from DB: No.38 / 265: CRM\n",
      "Loadig Data from DB: No.39 / 265: TLT\n",
      "Loadig Data from DB: No.40 / 265: VXX\n",
      "Loadig Data from DB: No.41 / 265: 000001.SS\n",
      "Loadig Data from DB: No.42 / 265: EWY\n",
      "Loadig Data from DB: No.43 / 265: FXE\n",
      "Loadig Data from DB: No.44 / 265: UVXY\n",
      "Loadig Data from DB: No.45 / 265: DD\n",
      "Loadig Data from DB: No.46 / 265: EWJ\n",
      "Loadig Data from DB: No.47 / 265: STZ\n",
      "Loadig Data from DB: No.48 / 265: AGQ\n",
      "Loadig Data from DB: No.49 / 265: LLY\n",
      "Loadig Data from DB: No.50 / 265: T\n",
      "Loadig Data from DB: No.51 / 265: V\n",
      "Loadig Data from DB: No.52 / 265: UPS\n",
      "Loadig Data from DB: No.53 / 265: ERX\n",
      "Loadig Data from DB: No.54 / 265: PLD\n",
      "Loadig Data from DB: No.55 / 265: VCNX\n",
      "Loadig Data from DB: No.56 / 265: USD\n",
      "Loadig Data from DB: No.57 / 265: APD\n",
      "Loadig Data from DB: No.58 / 265: BMY\n",
      "Loadig Data from DB: No.59 / 265: XLC\n",
      "Loadig Data from DB: No.60 / 265: KO\n",
      "Loadig Data from DB: No.61 / 265: VLDR\n",
      "Loadig Data from DB: No.62 / 265: EBAY\n",
      "Loadig Data from DB: No.63 / 265: ADP\n",
      "Loadig Data from DB: No.64 / 265: QS\n",
      "Loadig Data from DB: No.65 / 265: XL\n",
      "Loadig Data from DB: No.66 / 265: CZR\n",
      "Loadig Data from DB: No.67 / 265: LVS\n",
      "Loadig Data from DB: No.68 / 265: PBW\n",
      "Loadig Data from DB: No.69 / 265: NVAX\n",
      "Loadig Data from DB: No.70 / 265: COUP\n",
      "Loadig Data from DB: No.71 / 265: SHOP\n",
      "Loadig Data from DB: No.72 / 265: TSLA\n",
      "Loadig Data from DB: No.73 / 265: TGT\n",
      "Loadig Data from DB: No.74 / 265: TMUS\n",
      "Loadig Data from DB: No.75 / 265: CHWY\n",
      "Loadig Data from DB: No.76 / 265: GDDY\n",
      "Loadig Data from DB: No.77 / 265: PLUG\n",
      "Loadig Data from DB: No.78 / 265: MA\n",
      "Loadig Data from DB: No.79 / 265: MCD\n",
      "Loadig Data from DB: No.80 / 265: RACE\n",
      "Loadig Data from DB: No.81 / 265: BABA\n",
      "Loadig Data from DB: No.82 / 265: ARKG\n",
      "Loadig Data from DB: No.83 / 265: UNH\n",
      "Loadig Data from DB: No.84 / 265: LTHM\n",
      "Loadig Data from DB: No.85 / 265: DHR\n",
      "Loadig Data from DB: No.86 / 265: GOOG\n",
      "Loadig Data from DB: No.87 / 265: NEE\n",
      "Loadig Data from DB: No.88 / 265: SCO\n",
      "Loadig Data from DB: No.89 / 265: TNA\n",
      "Loadig Data from DB: No.90 / 265: SO\n",
      "Loadig Data from DB: No.91 / 265: SQM\n",
      "Loadig Data from DB: No.92 / 265: LMT\n",
      "Loadig Data from DB: No.93 / 265: MU\n",
      "Loadig Data from DB: No.94 / 265: MS\n",
      "Loadig Data from DB: No.95 / 265: XLV\n",
      "Loadig Data from DB: No.96 / 265: PEP\n",
      "Loadig Data from DB: No.97 / 265: EDC\n",
      "Loadig Data from DB: No.98 / 265: UPRO\n",
      "Loadig Data from DB: No.99 / 265: ^IXIC\n",
      "Loadig Data from DB: No.100 / 265: SMH\n",
      "Loadig Data from DB: No.101 / 265: TMO\n",
      "Loadig Data from DB: No.102 / 265: SAM\n",
      "Loadig Data from DB: No.103 / 265: AMZN\n",
      "Loadig Data from DB: No.104 / 265: DLR\n",
      "Loadig Data from DB: No.105 / 265: EQIX\n",
      "Loadig Data from DB: No.106 / 265: TSM\n",
      "Loadig Data from DB: No.107 / 265: WES\n",
      "Loadig Data from DB: No.108 / 265: HON\n",
      "Loadig Data from DB: No.109 / 265: GILD\n",
      "Loadig Data from DB: No.110 / 265: NUGT\n",
      "Loadig Data from DB: No.111 / 265: EWZ\n",
      "Loadig Data from DB: No.112 / 265: OSTK\n",
      "Loadig Data from DB: No.113 / 265: UDOW\n",
      "Loadig Data from DB: No.114 / 265: EUO\n",
      "Loadig Data from DB: No.115 / 265: XLRE\n",
      "Loadig Data from DB: No.116 / 265: VEEV\n",
      "Loadig Data from DB: No.117 / 265: ZM\n",
      "Loadig Data from DB: No.118 / 265: AMT\n",
      "Loadig Data from DB: No.119 / 265: XLP\n",
      "Loadig Data from DB: No.120 / 265: NKE\n",
      "Loadig Data from DB: No.121 / 265: PFE\n",
      "Loadig Data from DB: No.122 / 265: RNG\n",
      "Loadig Data from DB: No.123 / 265: MET\n",
      "Loadig Data from DB: No.124 / 265: ENPH\n",
      "Loadig Data from DB: No.125 / 265: PAVE\n",
      "Loadig Data from DB: No.126 / 265: HUBS\n",
      "Loadig Data from DB: No.127 / 265: FCEL\n",
      "Loadig Data from DB: No.128 / 265: DGP\n",
      "Loadig Data from DB: No.129 / 265: CB\n",
      "Loadig Data from DB: No.130 / 265: DUK\n",
      "Loadig Data from DB: No.131 / 265: TSN\n",
      "Loadig Data from DB: No.132 / 265: IEF\n",
      "Loadig Data from DB: No.133 / 265: EXC\n",
      "Loadig Data from DB: No.134 / 265: SOXL\n",
      "Loadig Data from DB: No.135 / 265: FMC\n",
      "Loadig Data from DB: No.136 / 265: TWLO\n",
      "Loadig Data from DB: No.137 / 265: FXY\n",
      "Loadig Data from DB: No.138 / 265: INTU\n",
      "Loadig Data from DB: No.139 / 265: MATL\n",
      "Loadig Data from DB: No.140 / 265: SPOT\n",
      "Loadig Data from DB: No.141 / 265: BIDU\n",
      "Loadig Data from DB: No.142 / 265: JD\n",
      "Loadig Data from DB: No.143 / 265: OKTA\n",
      "Loadig Data from DB: No.144 / 265: TTD\n",
      "Loadig Data from DB: No.145 / 265: FAS\n",
      "Loadig Data from DB: No.146 / 265: TMF\n",
      "Loadig Data from DB: No.147 / 265: VIR\n",
      "Loadig Data from DB: No.148 / 265: XLI\n",
      "Loadig Data from DB: No.149 / 265: UNP\n",
      "Loadig Data from DB: No.150 / 265: FLS\n",
      "Loadig Data from DB: No.151 / 265: LIN\n",
      "Loadig Data from DB: No.152 / 265: ZEN\n",
      "Loadig Data from DB: No.153 / 265: GDX\n",
      "Loadig Data from DB: No.154 / 265: SPY\n",
      "Loadig Data from DB: No.155 / 265: SBAC\n",
      "Loadig Data from DB: No.156 / 265: EWL\n",
      "Loadig Data from DB: No.157 / 265: XPP\n",
      "Loadig Data from DB: No.158 / 265: QCOM\n",
      "Loadig Data from DB: No.159 / 265: BX\n",
      "Loadig Data from DB: No.160 / 265: ARKW\n",
      "Loadig Data from DB: No.161 / 265: ISRG\n",
      "Loadig Data from DB: No.162 / 265: EL\n",
      "Loadig Data from DB: No.163 / 265: LULU\n",
      "Loadig Data from DB: No.164 / 265: SAP\n",
      "Loadig Data from DB: No.165 / 265: BBY\n",
      "Loadig Data from DB: No.166 / 265: CHTR\n",
      "Loadig Data from DB: No.167 / 265: EWU\n",
      "Loadig Data from DB: No.168 / 265: MRNA\n",
      "Loadig Data from DB: No.169 / 265: GLD\n",
      "Loadig Data from DB: No.170 / 265: XEL\n",
      "Loadig Data from DB: No.171 / 265: WMT\n",
      "Loadig Data from DB: No.172 / 265: CMG\n",
      "Loadig Data from DB: No.173 / 265: AMGN\n",
      "Loadig Data from DB: No.174 / 265: RIOT\n",
      "Loadig Data from DB: No.175 / 265: XLY\n",
      "Loadig Data from DB: No.176 / 265: XPEV\n",
      "Loadig Data from DB: No.177 / 265: XLU\n",
      "Loadig Data from DB: No.178 / 265: INO\n",
      "Loadig Data from DB: No.179 / 265: FXB\n",
      "Loadig Data from DB: No.180 / 265: CDAY\n",
      "Loadig Data from DB: No.181 / 265: EET\n",
      "Loadig Data from DB: No.182 / 265: PSA\n",
      "Loadig Data from DB: No.183 / 265: SMAR\n",
      "Loadig Data from DB: No.184 / 265: SCCO\n",
      "Loadig Data from DB: No.185 / 265: NEM\n",
      "Loadig Data from DB: No.186 / 265: DBX\n",
      "Loadig Data from DB: No.187 / 265: PAYC\n",
      "Loadig Data from DB: No.188 / 265: SRE\n",
      "Loadig Data from DB: No.189 / 265: AZO\n",
      "Loadig Data from DB: No.190 / 265: DIG\n",
      "Loadig Data from DB: No.191 / 265: SBE\n",
      "Loadig Data from DB: No.192 / 265: EBON\n",
      "Loadig Data from DB: No.193 / 265: PTON\n",
      "Loadig Data from DB: No.194 / 265: INTC\n",
      "Loadig Data from DB: No.195 / 265: FB\n",
      "Loadig Data from DB: No.196 / 265: TEAM\n",
      "Loadig Data from DB: No.197 / 265: NIO\n",
      "Loadig Data from DB: No.198 / 265: MRK\n",
      "Loadig Data from DB: No.199 / 265: SBUX\n",
      "Loadig Data from DB: No.200 / 265: LAC\n",
      "Loadig Data from DB: No.201 / 265: HD\n",
      "Loadig Data from DB: No.202 / 265: EWG\n",
      "Loadig Data from DB: No.203 / 265: COST\n",
      "Loadig Data from DB: No.204 / 265: XLE\n",
      "Loadig Data from DB: No.205 / 265: BLNK\n",
      "Loadig Data from DB: No.206 / 265: ARKF\n",
      "Loadig Data from DB: No.207 / 265: ^GSPC\n",
      "Loadig Data from DB: No.208 / 265: D\n",
      "Loadig Data from DB: No.209 / 265: GOOGL\n",
      "Loadig Data from DB: No.210 / 265: ORCL\n",
      "Loadig Data from DB: No.211 / 265: EWA\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Loadig Data from DB: No.212 / 265: WORK\n",
      "Loadig Data from DB: No.213 / 265: UBT\n",
      "Loadig Data from DB: No.214 / 265: MSFT\n",
      "Loadig Data from DB: No.215 / 265: AAPL\n",
      "Loadig Data from DB: No.216 / 265: DDOG\n",
      "Loadig Data from DB: No.217 / 265: LAZR\n",
      "Loadig Data from DB: No.218 / 265: XLF\n",
      "Loadig Data from DB: No.219 / 265: AXP\n",
      "Loadig Data from DB: No.220 / 265: SHW\n",
      "Loadig Data from DB: No.221 / 265: PM\n",
      "Loadig Data from DB: No.222 / 265: UGL\n",
      "Loadig Data from DB: No.223 / 265: SPLK\n",
      "Loadig Data from DB: No.224 / 265: BILI\n",
      "Loadig Data from DB: No.225 / 265: WDAY\n",
      "Loadig Data from DB: No.226 / 265: WFC\n",
      "Loadig Data from DB: No.227 / 265: UCO\n",
      "Loadig Data from DB: No.228 / 265: EWT\n",
      "Loadig Data from DB: No.229 / 265: BAC\n",
      "Loadig Data from DB: No.230 / 265: ADBE\n",
      "Loadig Data from DB: No.231 / 265: QQQ\n",
      "Loadig Data from DB: No.232 / 265: DRN\n",
      "Loadig Data from DB: No.233 / 265: KHC\n",
      "Loadig Data from DB: No.234 / 265: ECL\n",
      "Loadig Data from DB: No.235 / 265: CAT\n",
      "Loadig Data from DB: No.236 / 265: DBC\n",
      "Loadig Data from DB: No.237 / 265: RTX\n",
      "Loadig Data from DB: No.238 / 265: CCI\n",
      "Loadig Data from DB: No.239 / 265: ATVI\n",
      "Loadig Data from DB: No.240 / 265: CRWD\n",
      "Loadig Data from DB: No.241 / 265: RSX\n",
      "Loadig Data from DB: No.242 / 265: INDA\n",
      "Loadig Data from DB: No.243 / 265: ALB\n",
      "Loadig Data from DB: No.244 / 265: ADSK\n",
      "Loadig Data from DB: No.245 / 265: XLK\n",
      "Loadig Data from DB: No.246 / 265: ABBV\n",
      "Loadig Data from DB: No.247 / 265: CSCO\n",
      "Loadig Data from DB: No.248 / 265: PYPL\n",
      "Loadig Data from DB: No.249 / 265: NVDA\n",
      "Loadig Data from DB: No.250 / 265: XLB\n",
      "Loadig Data from DB: No.251 / 265: UYG\n",
      "Loadig Data from DB: No.252 / 265: BNTX\n",
      "Loadig Data from DB: No.253 / 265: AZN\n",
      "Loadig Data from DB: No.254 / 265: RUN\n",
      "Loadig Data from DB: No.255 / 265: ^HSI\n",
      "Loadig Data from DB: No.256 / 265: MDT\n",
      "Loadig Data from DB: No.257 / 265: OPEN\n",
      "Loadig Data from DB: No.258 / 265: TQQQ\n",
      "Loadig Data from DB: No.259 / 265: AMD\n",
      "Loadig Data from DB: No.260 / 265: BLK\n",
      "Loadig Data from DB: No.261 / 265: CYB\n",
      "Loadig Data from DB: No.262 / 265: DBA\n",
      "Loadig Data from DB: No.263 / 265: EWH\n",
      "Loadig Data from DB: No.264 / 265: NOVA\n",
      "Loadig Data from DB: No.265 / 265: LI\n"
     ]
    }
   ],
   "source": [
    "data_list_selected = LOAD_DATA.read_data_from_folders(us_tickers, us_db_path)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Signals(D) Prepared for No.1 : AEP\n",
      "Signals(D) Prepared for No.2 : MMM\n",
      "Signals(D) Prepared for No.3 : DOCU\n",
      "Signals(D) Prepared for No.4 : FXI\n",
      "Signals(D) Prepared for No.5 : LOW\n",
      "Signals(D) Prepared for No.6 : VZ\n",
      "Signals(D) Prepared for No.7 : MARA\n",
      "Signals(D) Prepared for No.8 : DIS\n",
      "Signals(D) Prepared for No.9 : FXF\n",
      "Signals(D) Prepared for No.10 : JNJ\n",
      "Signals(D) Prepared for No.11 : EWC\n",
      "Signals(D) Prepared for No.12 : URE\n",
      "Signals(D) Prepared for No.13 : UYM\n",
      "Signals(D) Prepared for No.14 : JPM\n",
      "Signals(D) Prepared for No.15 : CMCSA\n",
      "Signals(D) Prepared for No.16 : GBTC\n",
      "Signals(D) Prepared for No.17 : TME\n",
      "Signals(D) Prepared for No.18 : CVS\n",
      "Signals(D) Prepared for No.19 : CAN\n",
      "Signals(D) Prepared for No.20 : EWW\n",
      "Signals(D) Prepared for No.21 : PDD\n",
      "Signals(D) Prepared for No.22 : ARKQ\n",
      "Signals(D) Prepared for No.23 : GE\n",
      "Signals(D) Prepared for No.24 : ES\n",
      "Signals(D) Prepared for No.25 : ARKK\n",
      "Signals(D) Prepared for No.26 : NOW\n",
      "Signals(D) Prepared for No.27 : SQ\n",
      "Signals(D) Prepared for No.28 : PG\n",
      "Signals(D) Prepared for No.29 : BA\n",
      "Signals(D) Prepared for No.30 : ^DJI\n",
      "Signals(D) Prepared for No.31 : NFLX\n",
      "Signals(D) Prepared for No.32 : GS\n",
      "Signals(D) Prepared for No.33 : UUP\n",
      "Signals(D) Prepared for No.34 : C\n",
      "Signals(D) Prepared for No.35 : ABT\n",
      "Signals(D) Prepared for No.36 : YINN\n",
      "Signals(D) Prepared for No.37 : CL\n",
      "Signals(D) Prepared for No.38 : CRM\n",
      "Signals(D) Prepared for No.39 : TLT\n",
      "Signals(D) Prepared for No.40 : VXX\n",
      "Signals(D) Prepared for No.41 : 000001.SS\n",
      "Signals(D) Prepared for No.42 : EWY\n",
      "Signals(D) Prepared for No.43 : FXE\n",
      "Signals(D) Prepared for No.44 : UVXY\n",
      "Signals(D) Prepared for No.45 : DD\n",
      "Signals(D) Prepared for No.46 : EWJ\n",
      "Signals(D) Prepared for No.47 : STZ\n",
      "Signals(D) Prepared for No.48 : AGQ\n",
      "Signals(D) Prepared for No.49 : LLY\n",
      "Signals(D) Prepared for No.50 : T\n",
      "Signals(D) Prepared for No.51 : V\n",
      "Signals(D) Prepared for No.52 : UPS\n",
      "Signals(D) Prepared for No.53 : ERX\n",
      "Signals(D) Prepared for No.54 : PLD\n",
      "Signals(D) Prepared for No.55 : VCNX\n",
      "Signals(D) Prepared for No.56 : USD\n",
      "Signals(D) Prepared for No.57 : APD\n",
      "Signals(D) Prepared for No.58 : BMY\n",
      "Signals(D) Prepared for No.59 : XLC\n",
      "Signals(D) Prepared for No.60 : KO\n",
      "Signals(D) Prepared for No.61 : VLDR\n",
      "Signals(D) Prepared for No.62 : EBAY\n",
      "Signals(D) Prepared for No.63 : ADP\n",
      "Signals(D) Prepared for No.64 : QS\n",
      "Signals(D) Prepared for No.65 : XL\n",
      "Signals(D) Prepared for No.66 : CZR\n",
      "Signals(D) Prepared for No.67 : LVS\n",
      "Signals(D) Prepared for No.68 : PBW\n",
      "Signals(D) Prepared for No.69 : NVAX\n",
      "Signals(D) Prepared for No.70 : COUP\n",
      "Signals(D) Prepared for No.71 : SHOP\n",
      "Signals(D) Prepared for No.72 : TSLA\n",
      "Signals(D) Prepared for No.73 : TGT\n",
      "Signals(D) Prepared for No.74 : TMUS\n",
      "Signals(D) Prepared for No.75 : CHWY\n",
      "Signals(D) Prepared for No.76 : GDDY\n",
      "Signals(D) Prepared for No.77 : PLUG\n",
      "Signals(D) Prepared for No.78 : MA\n",
      "Signals(D) Prepared for No.79 : MCD\n",
      "Signals(D) Prepared for No.80 : RACE\n",
      "Signals(D) Prepared for No.81 : BABA\n",
      "Signals(D) Prepared for No.82 : ARKG\n",
      "Signals(D) Prepared for No.83 : UNH\n",
      "Signals(D) Prepared for No.84 : LTHM\n",
      "Signals(D) Prepared for No.85 : DHR\n",
      "Signals(D) Prepared for No.86 : GOOG\n",
      "Signals(D) Prepared for No.87 : NEE\n",
      "Signals(D) Prepared for No.88 : SCO\n",
      "Signals(D) Prepared for No.89 : TNA\n",
      "Signals(D) Prepared for No.90 : SO\n",
      "Signals(D) Prepared for No.91 : SQM\n",
      "Signals(D) Prepared for No.92 : LMT\n",
      "Signals(D) Prepared for No.93 : MU\n",
      "Signals(D) Prepared for No.94 : MS\n",
      "Signals(D) Prepared for No.95 : XLV\n",
      "Signals(D) Prepared for No.96 : PEP\n",
      "Signals(D) Prepared for No.97 : EDC\n",
      "Signals(D) Prepared for No.98 : UPRO\n",
      "Signals(D) Prepared for No.99 : ^IXIC\n",
      "Signals(D) Prepared for No.100 : SMH\n",
      "Signals(D) Prepared for No.101 : TMO\n",
      "Signals(D) Prepared for No.102 : SAM\n",
      "Signals(D) Prepared for No.103 : AMZN\n",
      "Signals(D) Prepared for No.104 : DLR\n",
      "Signals(D) Prepared for No.105 : EQIX\n",
      "Signals(D) Prepared for No.106 : TSM\n",
      "Signals(D) Prepared for No.107 : WES\n",
      "Signals(D) Prepared for No.108 : HON\n",
      "Signals(D) Prepared for No.109 : GILD\n",
      "Signals(D) Prepared for No.110 : NUGT\n",
      "Signals(D) Prepared for No.111 : EWZ\n",
      "Signals(D) Prepared for No.112 : OSTK\n",
      "Signals(D) Prepared for No.113 : UDOW\n",
      "Signals(D) Prepared for No.114 : EUO\n",
      "Signals(D) Prepared for No.115 : XLRE\n",
      "Signals(D) Prepared for No.116 : VEEV\n",
      "Signals(D) Prepared for No.117 : ZM\n",
      "Signals(D) Prepared for No.118 : AMT\n",
      "Signals(D) Prepared for No.119 : XLP\n",
      "Signals(D) Prepared for No.120 : NKE\n",
      "Signals(D) Prepared for No.121 : PFE\n",
      "Signals(D) Prepared for No.122 : RNG\n",
      "Signals(D) Prepared for No.123 : MET\n",
      "Signals(D) Prepared for No.124 : ENPH\n",
      "Signals(D) Prepared for No.125 : PAVE\n",
      "Signals(D) Prepared for No.126 : HUBS\n",
      "Signals(D) Prepared for No.127 : FCEL\n",
      "Signals(D) Prepared for No.128 : DGP\n",
      "Signals(D) Prepared for No.129 : CB\n",
      "Signals(D) Prepared for No.130 : DUK\n",
      "Signals(D) Prepared for No.131 : TSN\n",
      "Signals(D) Prepared for No.132 : IEF\n",
      "Signals(D) Prepared for No.133 : EXC\n",
      "Signals(D) Prepared for No.134 : SOXL\n",
      "Signals(D) Prepared for No.135 : FMC\n",
      "Signals(D) Prepared for No.136 : TWLO\n",
      "Signals(D) Prepared for No.137 : FXY\n",
      "Signals(D) Prepared for No.138 : INTU\n",
      "list index out of range\n",
      "Signals(D) Prepared for No.140 : SPOT\n",
      "Signals(D) Prepared for No.141 : BIDU\n",
      "Signals(D) Prepared for No.142 : JD\n",
      "Signals(D) Prepared for No.143 : OKTA\n",
      "Signals(D) Prepared for No.144 : TTD\n",
      "Signals(D) Prepared for No.145 : FAS\n",
      "Signals(D) Prepared for No.146 : TMF\n",
      "Signals(D) Prepared for No.147 : VIR\n",
      "Signals(D) Prepared for No.148 : XLI\n",
      "Signals(D) Prepared for No.149 : UNP\n",
      "Signals(D) Prepared for No.150 : FLS\n",
      "Signals(D) Prepared for No.151 : LIN\n",
      "Signals(D) Prepared for No.152 : ZEN\n",
      "Signals(D) Prepared for No.153 : GDX\n",
      "Signals(D) Prepared for No.154 : SPY\n",
      "Signals(D) Prepared for No.155 : SBAC\n",
      "Signals(D) Prepared for No.156 : EWL\n",
      "Signals(D) Prepared for No.157 : XPP\n",
      "Signals(D) Prepared for No.158 : QCOM\n",
      "Signals(D) Prepared for No.159 : BX\n",
      "Signals(D) Prepared for No.160 : ARKW\n",
      "Signals(D) Prepared for No.161 : ISRG\n",
      "Signals(D) Prepared for No.162 : EL\n",
      "Signals(D) Prepared for No.163 : LULU\n",
      "Signals(D) Prepared for No.164 : SAP\n",
      "Signals(D) Prepared for No.165 : BBY\n",
      "Signals(D) Prepared for No.166 : CHTR\n",
      "Signals(D) Prepared for No.167 : EWU\n",
      "Signals(D) Prepared for No.168 : MRNA\n",
      "Signals(D) Prepared for No.169 : GLD\n",
      "Signals(D) Prepared for No.170 : XEL\n",
      "Signals(D) Prepared for No.171 : WMT\n",
      "Signals(D) Prepared for No.172 : CMG\n",
      "Signals(D) Prepared for No.173 : AMGN\n",
      "Signals(D) Prepared for No.174 : RIOT\n",
      "Signals(D) Prepared for No.175 : XLY\n",
      "Signals(D) Prepared for No.176 : XPEV\n",
      "Signals(D) Prepared for No.177 : XLU\n",
      "Signals(D) Prepared for No.178 : INO\n",
      "Signals(D) Prepared for No.179 : FXB\n",
      "Signals(D) Prepared for No.180 : CDAY\n",
      "Signals(D) Prepared for No.181 : EET\n",
      "Signals(D) Prepared for No.182 : PSA\n",
      "Signals(D) Prepared for No.183 : SMAR\n",
      "Signals(D) Prepared for No.184 : SCCO\n",
      "Signals(D) Prepared for No.185 : NEM\n",
      "Signals(D) Prepared for No.186 : DBX\n",
      "Signals(D) Prepared for No.187 : PAYC\n",
      "Signals(D) Prepared for No.188 : SRE\n",
      "Signals(D) Prepared for No.189 : AZO\n",
      "Signals(D) Prepared for No.190 : DIG\n",
      "Signals(D) Prepared for No.191 : SBE\n",
      "Signals(D) Prepared for No.192 : EBON\n",
      "Signals(D) Prepared for No.193 : PTON\n",
      "Signals(D) Prepared for No.194 : INTC\n",
      "Signals(D) Prepared for No.195 : FB\n",
      "Signals(D) Prepared for No.196 : TEAM\n",
      "Signals(D) Prepared for No.197 : NIO\n",
      "Signals(D) Prepared for No.198 : MRK\n",
      "Signals(D) Prepared for No.199 : SBUX\n",
      "Signals(D) Prepared for No.200 : LAC\n",
      "Signals(D) Prepared for No.201 : HD\n",
      "Signals(D) Prepared for No.202 : EWG\n",
      "Signals(D) Prepared for No.203 : COST\n",
      "Signals(D) Prepared for No.204 : XLE\n",
      "Signals(D) Prepared for No.205 : BLNK\n",
      "Signals(D) Prepared for No.206 : ARKF\n",
      "Signals(D) Prepared for No.207 : ^GSPC\n",
      "Signals(D) Prepared for No.208 : D\n",
      "Signals(D) Prepared for No.209 : GOOGL\n",
      "Signals(D) Prepared for No.210 : ORCL\n",
      "Signals(D) Prepared for No.211 : EWA\n",
      "Signals(D) Prepared for No.212 : WORK\n",
      "Signals(D) Prepared for No.213 : UBT\n",
      "Signals(D) Prepared for No.214 : MSFT\n",
      "Signals(D) Prepared for No.215 : AAPL\n",
      "Signals(D) Prepared for No.216 : DDOG\n",
      "Signals(D) Prepared for No.217 : LAZR\n",
      "Signals(D) Prepared for No.218 : XLF\n",
      "Signals(D) Prepared for No.219 : AXP\n",
      "Signals(D) Prepared for No.220 : SHW\n",
      "Signals(D) Prepared for No.221 : PM\n",
      "Signals(D) Prepared for No.222 : UGL\n",
      "Signals(D) Prepared for No.223 : SPLK\n",
      "Signals(D) Prepared for No.224 : BILI\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Signals(D) Prepared for No.225 : WDAY\n",
      "Signals(D) Prepared for No.226 : WFC\n",
      "Signals(D) Prepared for No.227 : UCO\n",
      "Signals(D) Prepared for No.228 : EWT\n",
      "Signals(D) Prepared for No.229 : BAC\n",
      "Signals(D) Prepared for No.230 : ADBE\n",
      "Signals(D) Prepared for No.231 : QQQ\n",
      "Signals(D) Prepared for No.232 : DRN\n",
      "Signals(D) Prepared for No.233 : KHC\n",
      "Signals(D) Prepared for No.234 : ECL\n",
      "Signals(D) Prepared for No.235 : CAT\n",
      "Signals(D) Prepared for No.236 : DBC\n",
      "Signals(D) Prepared for No.237 : RTX\n",
      "Signals(D) Prepared for No.238 : CCI\n",
      "Signals(D) Prepared for No.239 : ATVI\n",
      "Signals(D) Prepared for No.240 : CRWD\n",
      "Signals(D) Prepared for No.241 : RSX\n",
      "Signals(D) Prepared for No.242 : INDA\n",
      "Signals(D) Prepared for No.243 : ALB\n",
      "Signals(D) Prepared for No.244 : ADSK\n",
      "Signals(D) Prepared for No.245 : XLK\n",
      "Signals(D) Prepared for No.246 : ABBV\n",
      "Signals(D) Prepared for No.247 : CSCO\n",
      "Signals(D) Prepared for No.248 : PYPL\n",
      "Signals(D) Prepared for No.249 : NVDA\n",
      "Signals(D) Prepared for No.250 : XLB\n",
      "Signals(D) Prepared for No.251 : UYG\n",
      "Signals(D) Prepared for No.252 : BNTX\n",
      "Signals(D) Prepared for No.253 : AZN\n",
      "Signals(D) Prepared for No.254 : RUN\n",
      "Signals(D) Prepared for No.255 : ^HSI\n",
      "Signals(D) Prepared for No.256 : MDT\n",
      "Signals(D) Prepared for No.257 : OPEN\n",
      "Signals(D) Prepared for No.258 : TQQQ\n",
      "Signals(D) Prepared for No.259 : AMD\n",
      "Signals(D) Prepared for No.260 : BLK\n",
      "Signals(D) Prepared for No.261 : CYB\n",
      "Signals(D) Prepared for No.262 : DBA\n",
      "Signals(D) Prepared for No.263 : EWH\n",
      "Signals(D) Prepared for No.264 : NOVA\n",
      "Signals(D) Prepared for No.265 : LI\n",
      "-------------------------\n",
      "All Done!\n"
     ]
    }
   ],
   "source": [
    "# Generate signals\n",
    "daily_macd_updown_signals = GENERATE_SIGNALS.generate_signals_macd_updown_ma_slope( \n",
    "                                                                           data_list_selected,\n",
    "#                                                                            CN_fund_data,\n",
    "                                                                          \"Macd_Updown_MA_Slope_Signals\", \n",
    "                                                                          \"Date\", \n",
    "                                                                          \"Adj Close\", \n",
    "                                                                          \"Ticker\", \n",
    "                                                                          \"D\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-10-2094c7f15a0f>:2: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  daily_macd_updown_signals_to_present[\"满足的趋势形态\"] = \"前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\"\n"
     ]
    }
   ],
   "source": [
    "daily_macd_updown_signals_to_present = daily_macd_updown_signals[daily_macd_updown_signals['Signal']==\"买入\"]\n",
    "daily_macd_updown_signals_to_present[\"满足的趋势形态\"] = \"前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\"\n",
    "daily_macd_updown_signals_to_present.columns = ['股票代号','最新收盘日','信号','模型名称','模型频率','满足的趋势形态']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>股票代号</th>\n",
       "      <th>最新收盘日</th>\n",
       "      <th>满足的趋势形态</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AEP</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49</th>\n",
       "      <td>T</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62</th>\n",
       "      <td>ADP</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>72</th>\n",
       "      <td>TGT</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>78</th>\n",
       "      <td>MCD</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>79</th>\n",
       "      <td>RACE</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87</th>\n",
       "      <td>SCO</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89</th>\n",
       "      <td>SO</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>91</th>\n",
       "      <td>LMT</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>101</th>\n",
       "      <td>SAM</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>103</th>\n",
       "      <td>DLR</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>104</th>\n",
       "      <td>EQIX</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>107</th>\n",
       "      <td>HON</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112</th>\n",
       "      <td>UDOW</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>117</th>\n",
       "      <td>AMT</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>132</th>\n",
       "      <td>EXC</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>134</th>\n",
       "      <td>FMC</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>146</th>\n",
       "      <td>XLI</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>147</th>\n",
       "      <td>UNP</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>149</th>\n",
       "      <td>LIN</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>153</th>\n",
       "      <td>SBAC</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>168</th>\n",
       "      <td>XEL</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>169</th>\n",
       "      <td>WMT</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>175</th>\n",
       "      <td>XLU</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>186</th>\n",
       "      <td>SRE</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>197</th>\n",
       "      <td>SBUX</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>199</th>\n",
       "      <td>HD</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>201</th>\n",
       "      <td>COST</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>218</th>\n",
       "      <td>SHW</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>236</th>\n",
       "      <td>CCI</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>254</th>\n",
       "      <td>MDT</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     股票代号       最新收盘日                                     满足的趋势形态\n",
       "0     AEP  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "49      T  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "62    ADP  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "72    TGT  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "78    MCD  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "79   RACE  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "87    SCO  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "89     SO  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "91    LMT  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "101   SAM  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "103   DLR  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "104  EQIX  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "107   HON  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "112  UDOW  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "117   AMT  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "132   EXC  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "134   FMC  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "146   XLI  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "147   UNP  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "149   LIN  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "153  SBAC  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "168   XEL  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "169   WMT  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "175   XLU  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "186   SRE  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "197  SBUX  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "199    HD  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "201  COST  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "218   SHW  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "236   CCI  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态\n",
       "254   MDT  2021-04-05  前一日MACD值开始向上反转，并且价格收盘于5日均线之上，并且10日均线处于上升状态"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "daily_macd_updown_signals_to_present[['股票代号','最新收盘日','满足的趋势形态']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Ticker</th>\n",
       "      <th>Last_Date</th>\n",
       "      <th>Signal</th>\n",
       "      <th>model_name</th>\n",
       "      <th>model_freq</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>256</th>\n",
       "      <td>TQQQ</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>多头持有</td>\n",
       "      <td>Macd_Updown_MA_Slope_Signals</td>\n",
       "      <td>D</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Ticker   Last_Date Signal                    model_name model_freq\n",
       "256   TQQQ  2021-04-05   多头持有  Macd_Updown_MA_Slope_Signals          D"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "daily_macd_updown_signals[daily_macd_updown_signals[\"Ticker\"]==\"TQQQ\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "signal_path = \"C:/Users/Administrator/CE_github_2/data_pipeline/Signals/\"\n",
    "\n",
    "###################################\n",
    "signal_file = signal_path+end+\"_signals\"+\"_D_US_mkt\"+\".csv\"\n",
    "###################################\n",
    "\n",
    "# merged_daily_weekly.to_csv(signal_file)\n",
    "daily_macd_updown_signals.to_csv(signal_file)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
